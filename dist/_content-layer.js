"use strict";function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(o,t,n){return t&&e(o.prototype,t),n&&e(o,n),o}}(),ContentLayer=function(){function e(o,t,n,i){_classCallCheck(this,e),this._map=o,this._config=t,this.interactionPopup=n,this.activeItems=i}return _createClass(e,[{key:"draw",value:function(e){var o=this,t=void 0,n=void 0,i=void 0,a=void 0;if(webgl_detect()&&!isIE11())o._map.addSource("markers",{type:"geojson",data:e}),o._map.addLayer({id:"icons",type:"symbol",source:"markers",layout:{"icon-image":{property:"type",type:"categorical",stops:[["project","projectIcon"],["blog","blogIcon"]]},"icon-padding":0,"icon-allow-overlap":!0,"icon-anchor":"bottom","icon-offset":[20,10],visibility:"visible"},paint:{"icon-opacity":1},filter:["any",["==","type","project"],["==","type","blog"]]}),o._config.highlights&&o._map.addLayer({id:"icons-active",type:"symbol",source:"markers",layout:{"icon-image":{property:"type",type:"categorical",stops:[["project","projectIconActive"],["blog","blogIconActive"]]},"icon-padding":0,"icon-allow-overlap":!0,"icon-anchor":"bottom","icon-offset":[15,10],visibility:"visible","icon-size":1},paint:{"icon-color":"#000"},filter:["all",["==","slug",""]]}),o._map.on("click","icons",function(e){o._map.getCanvas().style.cursor="pointer",t=o.interactionPopup.createPopup(e.features[0]),a=[18,-42],n=e.features[0].geometry.coordinates,i=e.features[0].properties.type,o.interactionPopup.openPopup(o._map,t,n,i,a)}),o._map.on("click","icons-active",function(e){o._map.getCanvas().style.cursor="pointer",t=o.interactionPopup.createPopup(e.features[0]),a=[16,-34],n=e.features[0].geometry.coordinates,i=e.features[0].properties.type,o.interactionPopup.openPopup(o._map,t,n,i,a)}),o.activeItems.setGL(o._config.activeItems);else{var r=void 0,c=[],s=void 0,p=void 0,l=void 0,u=new IconGenerator;e.features.forEach(function(e){"blog"===e.properties.type?l=u.blogIcon(e):"project"===e.properties.type&&(l=u.projectIcon(e)),r=L.marker([e.geometry.coordinates[1],e.geometry.coordinates[0]],{icon:l}),r.on("click",function(t){s=o.interactionPopup.createPopup(e),p=L.popup({className:e.properties.type,offset:[0,36]}).setLatLng(t.latlng).setContent(s).openOn(o._map)}),c.push(r)}),this.markers=new L.featureGroup(c),this.markers.addTo(o._map),o.activeItems.setJS(e,o._config.activeItems),o._map.fitBounds(o.markers.getBounds().pad(1))}}},{key:"zoom",value:function(){var e=this,o=e._config.dataset.lines.features[1].geometry.coordinates,t=o.reduce(function(e,o){return e.extend(o)},new mapboxgl.LngLatBounds(o[0],o[0]));e._map.fitBounds(t,{padding:100})}},{key:"addLegend",value:function(){var e=document.createElement("div");e.classList.add("legend"),self.hostContainer.appendChild(e)}},{key:"navigate",value:function(e){window.location.href=e}}]),e}();