"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),InteractionFilters=function(){function e(t,r,i,a){_classCallCheck(this,e),this._map=t,this._config=r,this._contentLayer=i,this._interactionPopup=a,this.filters=document.getElementById("filter-container"),this.filterArrayForJs=["blog","project","poi"],this.filters&&(this.blogFilter=this.filters.querySelector("#blog"),this.projectFilter=this.filters.querySelector("#project"),this.poiFilter=this.filters.querySelector("#poi"))}return _createClass(e,[{key:"init",value:function(){var e=this;e.filters&&(e.blogFilter.addEventListener("click",function(t){e.filterLayer(e._map,"icons","blog")},!1),e.projectFilter.addEventListener("click",function(t){e.filterLayer(e._map,"icons","project")},!1),e.poiFilter&&e.poiFilter.addEventListener("click",function(t){e.filterLayer(e._map,"poi")},!1))}},{key:"filterLayer",value:function(e,t,r){var i=this;webgl_detect()&&!isIE11()?i._GL_filterLayer(e,t,r):i._JS_filterLayer(e,t,r)}},{key:"_GL_filterLayer",value:function(e,t,r){var i=this,a=e.getFilter(t),o=["any"],n=void 0;"icons"!==t&&"icons-active"!==t||(n=a.filter(function(e){return e[2]===r}),n.length>0?(a.forEach(function(e){Array.isArray(e)&&e[2]!==r&&o.push(e)}),i.filters.querySelector("#"+r).classList.add("inactive")):(o=a,o.push(["==","type",r]),i.filters.querySelector("#"+r).classList.remove("inactive")),i._map.setFilter(t,o),i._map.setFilter("icons-active",["==","type",""]),i._interactionPopup.emptyArray()),"poi"===t&&("has"===i._map.getFilter(t)[0]?(i._map.setFilter(t,["!has","name"]),i.filters.querySelector("#poi").classList.add("inactive")):(i._map.setFilter(t,["has","name"]),i.filters.querySelector("#poi").classList.remove("inactive")))}},{key:"_JS_filterLayer",value:function(e,t,r){"poi"===t&&(r="poi");var i=this,a=void 0;i._map.closePopup(),i._map.eachLayer(function(e){e._icon&&e.remove()});var o,n=!1;i.filterArrayForJs.forEach(function(e){e===r&&(n=!0)}),n?(o=i.filterArrayForJs.indexOf(r),i.filterArrayForJs.splice(o,1),i.filters.querySelector("#"+r).classList.add("inactive")):(i.filterArrayForJs.push(r),console.log(r),i.filters.querySelector("#"+r).classList.remove("inactive"));var l=!1;if(i.filterArrayForJs.forEach(function(e){"poi"===e&&(l=!0)}),l&&(i._poi=new PoiLayer(i._map,i._config),i._poi.draw()),a=i._config.dataset.content.features.filter(function(e){var t=!1;if(i.filterArrayForJs.forEach(function(r){e.properties.type===r&&(t=!0)}),t)return e}),a.length>0)var s={type:"FeatureCollection",features:a};this._contentLayer.draw(s)}}]),e}();